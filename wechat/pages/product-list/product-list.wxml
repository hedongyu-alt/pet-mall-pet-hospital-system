<!--pages/product-list/product-list.wxml-->
<view class="product-list-container">
  <!-- æœç´¢ç­›é€‰åŒºåŸŸ -->
  <view class="search-section card">
    <view class="search-bar">
      <input class="search-input" placeholder="æœç´¢å•†å“åç§°æˆ–å“ç‰Œ" value="{{searchKeyword}}" bindinput="onSearchInput" />
      <button class="search-btn" bindtap="handleSearch">æœç´¢</button>
    </view>

    <!-- ç­›é€‰æŒ‰é’® -->
    <view class="filter-section">
      <view class="filter-group">
        <view class="filter-label">å•†å“åˆ†ç±»ï¼š</view>
        <scroll-view class="filter-scroll" scroll-x="{{true}}">
          <view class="filter-buttons">
            <view class="filter-btn {{categoryId === '' ? 'active' : ''}}" bindtap="filterByCategory" data-id="">
              å…¨éƒ¨
            </view>
            <view class="filter-btn {{categoryId === item.id ? 'active' : ''}}" wx:for="{{categories}}" wx:key="id" bindtap="filterByCategory" data-id="{{item.id}}">
              {{item.name}}
            </view>
          </view>
        </scroll-view>
      </view>

      <view class="filter-group">
        <view class="filter-label">å® ç‰©ç±»å‹ï¼š</view>
        <view class="filter-buttons">
          <view class="filter-btn {{petType === '' ? 'active' : ''}}" bindtap="filterByPetType" data-type="">
            å…¨éƒ¨
          </view>
          <view class="filter-btn {{petType === 'ç‹—' ? 'active' : ''}}" bindtap="filterByPetType" data-type="ç‹—">
            ç‹—
          </view>
          <view class="filter-btn {{petType === 'çŒ«' ? 'active' : ''}}" bindtap="filterByPetType" data-type="çŒ«">
            çŒ«
          </view>
        </view>
      </view>
    </view>
  </view>

  <!-- å•†å“åˆ—è¡¨ -->
  <view class="product-grid">
    <view class="product-card card" wx:for="{{productList}}" wx:key="id" bindtap="viewDetail" data-id="{{item.id}}">
      <image class="product-image" src="{{item.image}}" mode="aspectFill"></image>
      <view class="product-info">
        <view class="product-name">{{item.name}}</view>
        <view class="product-category">{{item.categoryName}} Â· {{item.petType}}</view>
        <view class="product-brand" wx:if="{{item.brand}}">å“ç‰Œï¼š{{item.brand}}</view>
        <view class="product-footer">
          <view class="product-price">Â¥{{item.price}}</view>
          <button class="add-cart-btn" catchtap="addToCart" data-item="{{item}}">åŠ è´­</button>
        </view>
      </view>
    </view>
  </view>

  <!-- ç©ºçŠ¶æ€ -->
  <view class="empty-state" wx:if="{{productList.length === 0}}">
    <view class="empty-icon">ğŸ“¦</view>
    <view class="empty-text">æš‚æ— å•†å“</view>
  </view>

  <!-- åŠ è½½æ›´å¤š -->
  <view class="load-more" wx:if="{{hasMore && productList.length > 0}}">
    <button class="load-more-btn" bindtap="loadMore">åŠ è½½æ›´å¤š</button>
  </view>
</view>

<!-- åŠ å…¥è´­ç‰©è½¦å¼¹çª— -->
<view class="cart-modal" wx:if="{{showCartModal}}" catchtap="closeCartModal">
  <view class="cart-modal-content" catchtap="stopPropagation">
    <view class="modal-header">
      <view class="modal-title">åŠ å…¥è´­ç‰©è½¦</view>
      <view class="modal-close" bindtap="closeCartModal">âœ•</view>
    </view>
    <view class="modal-body">
      <view class="modal-product-info">
        <image class="modal-product-image" src="{{selectedProduct.image}}" mode="aspectFill"></image>
        <view class="modal-product-name">{{selectedProduct.name}}</view>
      </view>
      <view class="modal-form-item">
        <view class="form-label">è´­ä¹°æ•°é‡</view>
        <view class="quantity-control">
          <button class="quantity-btn" bindtap="decreaseQuantity">-</button>
          <input class="quantity-input" type="number" value="{{cartQuantity}}" disabled />
          <button class="quantity-btn" bindtap="increaseQuantity">+</button>
        </view>
      </view>
    </view>
    <view class="modal-footer">
      <button class="modal-btn cancel-btn" bindtap="closeCartModal">å–æ¶ˆ</button>
      <button class="modal-btn confirm-btn" bindtap="confirmAddToCart">ç¡®å®š</button>
    </view>
  </view>
</view>


